\hypertarget{ion_8h}{\section{ion.\+h File Reference}
\label{ion_8h}\index{ion.\+h@{ion.\+h}}
}


Define all functions.  


{\ttfamily \#include \char`\"{}srfftw.\+h\char`\"{}}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_c_o_n_s_t_a_n_t_s}{C\+O\+N\+S\+T\+A\+N\+T\+S}
\begin{DoxyCompactList}\small\item\em Global variables. \end{DoxyCompactList}\item 
struct \hyperlink{structmy_m_p_i}{my\+M\+P\+I}
\begin{DoxyCompactList}\small\item\em M\+P\+I variables. \end{DoxyCompactList}\item 
struct \hyperlink{structparams}{params}
\begin{DoxyCompactList}\small\item\em Input Parameters. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ion_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(x, y)~((x)$<$(y) ?(x)\+:(y))
\item 
\#define \hyperlink{ion_8h_ac39d9cef6a5e030ba8d9e11121054268}{max}(x, y)~((x)$>$(y) ?(x)\+:(y))
\item 
\#define \hyperlink{ion_8h_a517275cd6d6e1b2731fc3f91a7c1f4e7}{I\+O\+N\+\_\+\+H\+\_\+}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ion_8h_aaceabff842284e2dc8f9611fdd0696bd}{make\+\_\+radii\+\_\+list} (float $\ast$radii\+\_\+p, float r\+\_\+min, float r\+\_\+max, float dr\+\_\+inc=constant.\+dr\+\_\+inc, float max\+\_\+dr=constants.\+max\+\_\+dr)
\item 
double \hyperlink{ion_8h_a665ce6685b219f01938fe7e1f4919465}{Get\+\_\+\+Current\+\_\+time} ()
\item 
void \hyperlink{ion_8h_ad4ddf14a0a19d8ece8aae44ea4bdc405}{pack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer} (fftw\+\_\+real $\ast$$\ast$$\ast$input, float $\ast$output, int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_a951c25f62971884a0b0aa5be6f903569}{unpack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer} (float $\ast$input, fftw\+\_\+real $\ast$$\ast$$\ast$output, int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_ae3e7c05c734d4e1b9516a11d79f07366}{pack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer} (fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$input, float $\ast$output, int Nnion, int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_a81c6a9dba70c6b44213dc05309f5a8a2}{unpack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer} (float $\ast$input, fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$output, int Nnion, int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_ad6241f690f16f77c1f942a96cb4e9e9c}{read\+\_\+density} (char $\ast$filename, float $\ast$buffer\+\_\+3d, double $\ast$robar\+\_\+p, int N1, int N2, int N3, float vomegam, float vomegab)
\item 
void \hyperlink{ion_8h_ad2f727cabe5ba3e264757f33d2d20fdc}{read\+\_\+xfrac} (char $\ast$dirname, float $\ast$buffer\+\_\+4d, float $\ast$nion\+\_\+list, int Nnion, int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_af0be7fa625cefb590988fcd6088eba60}{read\+\_\+sources} (char $\ast$filename, float $\ast$buffer\+\_\+3d, double $\ast$robarhalo\+\_\+p, int N1, int N2, int N3)
\item 
float $\ast$$\ast$ \hyperlink{ion_8h_a95e86e9acb1f854c98436818e8e32b44}{allocate\+\_\+float\+\_\+2d} (long N1, int N2)
\item 
fftw\+\_\+real $\ast$$\ast$$\ast$ \hyperlink{ion_8h_aee5c3609b2e190b1a88268997eb0a7dd}{allocate\+\_\+fftw\+\_\+real\+\_\+3d} (int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_aa8b5e455b9ae5c10e6b44ff5f28f8bf0}{Setting\+\_\+\+Up\+\_\+\+Memory\+\_\+\+For\+\_\+ionz} (int Nnion, int N1, int N2, int N3, fftw\+\_\+real $\ast$$\ast$$\ast$nh, fftw\+\_\+real $\ast$$\ast$$\ast$ngamma, fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$nxion)
\item 
void \hyperlink{ion_8h_a553eda876fc651efecef3202b2046c77}{smooth} (fftw\+\_\+real $\ast$$\ast$$\ast$ro\+\_\+dum, float Radii, int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_aa174d816f11484078e55fe5af64c211b}{reionization} (float Radii, fftw\+\_\+real $\ast$$\ast$$\ast$nh\+\_\+p, fftw\+\_\+real $\ast$$\ast$$\ast$ngamma\+\_\+p, fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$nxion\+\_\+p, float $\ast$nion\+\_\+p, int Nnion, int N1, int N2, int N3)
\item 
void \hyperlink{ion_8h_ab69d716af1dbf6ef48002cb900f32615}{read\+\_\+param} (char filename\mbox{[}2048\mbox{]})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_c_o_n_s_t_a_n_t_s}{C\+O\+N\+S\+T\+A\+N\+T\+S} \hyperlink{ion_8h_a1b21e15773869cae21bd1d502d49d715}{constants}
\item 
struct \hyperlink{structmy_m_p_i}{my\+M\+P\+I} \hyperlink{ion_8h_a6291b94bd446cba2e7517c12276ebd51}{mympi}
\item 
struct \hyperlink{structparams}{params} \hyperlink{ion_8h_a62c41a4636d22215339031855db0e48c}{input\+\_\+param}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Define all functions. 

\begin{DoxyAuthor}{Author}
Chaichalit Srisawat $<$ \href{mailto:boyd.srisawat@gmail.com}{\tt boyd.\+srisawat@gmail.\+com}$>$ 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
Sat Oct 11 20\+:49\+:08 2014 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\hypertarget{ion_8h_a517275cd6d6e1b2731fc3f91a7c1f4e7}{\index{ion.\+h@{ion.\+h}!I\+O\+N\+\_\+\+H\+\_\+@{I\+O\+N\+\_\+\+H\+\_\+}}
\index{I\+O\+N\+\_\+\+H\+\_\+@{I\+O\+N\+\_\+\+H\+\_\+}!ion.\+h@{ion.\+h}}
\subsubsection[{I\+O\+N\+\_\+\+H\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+O\+N\+\_\+\+H\+\_\+}}\label{ion_8h_a517275cd6d6e1b2731fc3f91a7c1f4e7}
\hypertarget{ion_8h_ac39d9cef6a5e030ba8d9e11121054268}{\index{ion.\+h@{ion.\+h}!max@{max}}
\index{max@{max}!ion.\+h@{ion.\+h}}
\subsubsection[{max}]{\setlength{\rightskip}{0pt plus 5cm}\#define max(
\begin{DoxyParamCaption}
\item[{}]{x, }
\item[{}]{y}
\end{DoxyParamCaption}
)~((x)$>$(y) ?(x)\+:(y))}}\label{ion_8h_ac39d9cef6a5e030ba8d9e11121054268}
\hypertarget{ion_8h_abb702d8b501669a23aa0ab3b281b9384}{\index{ion.\+h@{ion.\+h}!min@{min}}
\index{min@{min}!ion.\+h@{ion.\+h}}
\subsubsection[{min}]{\setlength{\rightskip}{0pt plus 5cm}\#define min(
\begin{DoxyParamCaption}
\item[{}]{x, }
\item[{}]{y}
\end{DoxyParamCaption}
)~((x)$<$(y) ?(x)\+:(y))}}\label{ion_8h_abb702d8b501669a23aa0ab3b281b9384}


\subsection{Function Documentation}
\hypertarget{ion_8h_aee5c3609b2e190b1a88268997eb0a7dd}{\index{ion.\+h@{ion.\+h}!allocate\+\_\+fftw\+\_\+real\+\_\+3d@{allocate\+\_\+fftw\+\_\+real\+\_\+3d}}
\index{allocate\+\_\+fftw\+\_\+real\+\_\+3d@{allocate\+\_\+fftw\+\_\+real\+\_\+3d}!ion.\+h@{ion.\+h}}
\subsubsection[{allocate\+\_\+fftw\+\_\+real\+\_\+3d}]{\setlength{\rightskip}{0pt plus 5cm}fftw\+\_\+real$\ast$$\ast$$\ast$ allocate\+\_\+fftw\+\_\+real\+\_\+3d (
\begin{DoxyParamCaption}
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_aee5c3609b2e190b1a88268997eb0a7dd}
Allocate 3\+D fftw\+\_\+real array


\begin{DoxyParams}{Parameters}
{\em N1} & 1st dimension len \\
\hline
{\em N2} & 2nd dimension len \\
\hline
{\em N3} & 3rd dimension len\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
3\+D fftw\+\_\+real array pointer 
\end{DoxyReturn}
\hypertarget{ion_8h_a95e86e9acb1f854c98436818e8e32b44}{\index{ion.\+h@{ion.\+h}!allocate\+\_\+float\+\_\+2d@{allocate\+\_\+float\+\_\+2d}}
\index{allocate\+\_\+float\+\_\+2d@{allocate\+\_\+float\+\_\+2d}!ion.\+h@{ion.\+h}}
\subsubsection[{allocate\+\_\+float\+\_\+2d}]{\setlength{\rightskip}{0pt plus 5cm}float$\ast$$\ast$ allocate\+\_\+float\+\_\+2d (
\begin{DoxyParamCaption}
\item[{long}]{N1, }
\item[{int}]{N2}
\end{DoxyParamCaption}
)}}\label{ion_8h_a95e86e9acb1f854c98436818e8e32b44}
\hypertarget{ion_8h_a665ce6685b219f01938fe7e1f4919465}{\index{ion.\+h@{ion.\+h}!Get\+\_\+\+Current\+\_\+time@{Get\+\_\+\+Current\+\_\+time}}
\index{Get\+\_\+\+Current\+\_\+time@{Get\+\_\+\+Current\+\_\+time}!ion.\+h@{ion.\+h}}
\subsubsection[{Get\+\_\+\+Current\+\_\+time}]{\setlength{\rightskip}{0pt plus 5cm}double Get\+\_\+\+Current\+\_\+time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ion_8h_a665ce6685b219f01938fe7e1f4919465}
Get current time

\begin{DoxyReturn}{Returns}
current time 
\end{DoxyReturn}
\hypertarget{ion_8h_aaceabff842284e2dc8f9611fdd0696bd}{\index{ion.\+h@{ion.\+h}!make\+\_\+radii\+\_\+list@{make\+\_\+radii\+\_\+list}}
\index{make\+\_\+radii\+\_\+list@{make\+\_\+radii\+\_\+list}!ion.\+h@{ion.\+h}}
\subsubsection[{make\+\_\+radii\+\_\+list}]{\setlength{\rightskip}{0pt plus 5cm}int make\+\_\+radii\+\_\+list (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{radii\+\_\+p, }
\item[{float}]{r\+\_\+min, }
\item[{float}]{r\+\_\+max, }
\item[{float}]{dr\+\_\+inc = {\ttfamily constant.dr\+\_\+inc}, }
\item[{float}]{max\+\_\+dr = {\ttfamily constants.max\+\_\+dr}}
\end{DoxyParamCaption}
)}}\label{ion_8h_aaceabff842284e2dc8f9611fdd0696bd}
Generate a list of radii to compute semi-\/numerical reionization


\begin{DoxyParams}{Parameters}
{\em radii\+\_\+p} & Pointer to radii list (pre-\/allocated) \\
\hline
{\em r\+\_\+min} & Minimum radius \\
\hline
{\em r\+\_\+max} & Maximum radius \\
\hline
{\em dr\+\_\+inc} & Increase in radius (0.\+0 $<$ dr\+\_\+inc $<$= 1.\+0; 0.\+1 by default) \\
\hline
{\em max\+\_\+dr} & Maximum increase in radius (2.\+0 by default) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total number of radii 
\end{DoxyReturn}
Test if n\+Radii $<$= max\+\_\+\+Nradii

Store radii list \hypertarget{ion_8h_ad4ddf14a0a19d8ece8aae44ea4bdc405}{\index{ion.\+h@{ion.\+h}!pack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer@{pack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer}}
\index{pack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer@{pack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer}!ion.\+h@{ion.\+h}}
\subsubsection[{pack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer}]{\setlength{\rightskip}{0pt plus 5cm}void pack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer (
\begin{DoxyParamCaption}
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$}]{input, }
\item[{float $\ast$}]{output, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_ad4ddf14a0a19d8ece8aae44ea4bdc405}
Convert 3\+D-\/fftw\+\_\+real array to 1\+D-\/float array. This is used to simplify M\+P\+I transfer process.


\begin{DoxyParams}{Parameters}
{\em input} & 3\+D-\/fftw\+\_\+real array input \\
\hline
{\em output} & 1\+D-\/float array output \\
\hline
{\em N1} & 1st dimension grid number \\
\hline
{\em N2} & 2nd dimension grid number \\
\hline
{\em N3} & 3rd dimension grid number \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_ae3e7c05c734d4e1b9516a11d79f07366}{\index{ion.\+h@{ion.\+h}!pack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer@{pack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer}}
\index{pack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer@{pack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer}!ion.\+h@{ion.\+h}}
\subsubsection[{pack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer}]{\setlength{\rightskip}{0pt plus 5cm}void pack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer (
\begin{DoxyParamCaption}
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$}]{input, }
\item[{float $\ast$}]{output, }
\item[{int}]{Nnion, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_ae3e7c05c734d4e1b9516a11d79f07366}
Convert 3\+D-\/fftw\+\_\+real array to 1\+D-\/float array. This is used to simplify M\+P\+I transfer process.


\begin{DoxyParams}{Parameters}
{\em input} & 3\+D-\/fftw\+\_\+real array output \\
\hline
{\em output} & 1\+D-\/float array input \\
\hline
{\em Nion} & Number of the choices of total reionizing photons/neutral baryon \\
\hline
{\em N1} & 1st dimension grid number \\
\hline
{\em N2} & 2nd dimension grid number \\
\hline
{\em N3} & 3rd dimension grid number \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_ad6241f690f16f77c1f942a96cb4e9e9c}{\index{ion.\+h@{ion.\+h}!read\+\_\+density@{read\+\_\+density}}
\index{read\+\_\+density@{read\+\_\+density}!ion.\+h@{ion.\+h}}
\subsubsection[{read\+\_\+density}]{\setlength{\rightskip}{0pt plus 5cm}void read\+\_\+density (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{filename, }
\item[{float $\ast$}]{buffer\+\_\+3d, }
\item[{double $\ast$}]{robar\+\_\+p, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3, }
\item[{float}]{vomegam, }
\item[{float}]{vomegab}
\end{DoxyParamCaption}
)}}\label{ion_8h_ad6241f690f16f77c1f942a96cb4e9e9c}
Read in density of matter in cubep3m format (Fortran binary)


\begin{DoxyParams}{Parameters}
{\em filename} & Filename (char$\ast$ input) \\
\hline
{\em buffer\+\_\+3d} & Output buffer\mbox{[}N1$\ast$\+N2$\ast$\+N3\mbox{]} \\
\hline
{\em robar\+\_\+p} & Average density of baryons (output) \\
\hline
{\em N1} & 1st dimension grid (input) \\
\hline
{\em N2} & 2nd dimension grid (input) \\
\hline
{\em N3} & 3rd dimension grid (input) \\
\hline
{\em vomegam} & Omega\+\_\+matter (input) \\
\hline
{\em vomegab} & Omega\+\_\+baryon (input) \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_ab69d716af1dbf6ef48002cb900f32615}{\index{ion.\+h@{ion.\+h}!read\+\_\+param@{read\+\_\+param}}
\index{read\+\_\+param@{read\+\_\+param}!ion.\+h@{ion.\+h}}
\subsubsection[{read\+\_\+param}]{\setlength{\rightskip}{0pt plus 5cm}void read\+\_\+param (
\begin{DoxyParamCaption}
\item[{char}]{filename\mbox{[}2048\mbox{]}}
\end{DoxyParamCaption}
)}}\label{ion_8h_ab69d716af1dbf6ef48002cb900f32615}
\hypertarget{ion_8h_af0be7fa625cefb590988fcd6088eba60}{\index{ion.\+h@{ion.\+h}!read\+\_\+sources@{read\+\_\+sources}}
\index{read\+\_\+sources@{read\+\_\+sources}!ion.\+h@{ion.\+h}}
\subsubsection[{read\+\_\+sources}]{\setlength{\rightskip}{0pt plus 5cm}void read\+\_\+sources (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{filename, }
\item[{float $\ast$}]{buffer\+\_\+3d, }
\item[{double $\ast$}]{robarhalo\+\_\+p, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_af0be7fa625cefb590988fcd6088eba60}
Read sources list. The data will be the S\+F\+R in cubep3m\+\_\+gridmass/year


\begin{DoxyParams}{Parameters}
{\em filename} & Filename (char$\ast$ input) \\
\hline
{\em buffer\+\_\+3d} & Output buffer\mbox{[}N1$\ast$\+N2$\ast$\+N3\mbox{]} \\
\hline
{\em robar\+\_\+p} & Average density of photons (output) \\
\hline
{\em N1} & 1st dimension grid (input) \\
\hline
{\em N2} & 2nd dimension grid (input) \\
\hline
{\em N3} & 3rd dimension grid (input) \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_ad2f727cabe5ba3e264757f33d2d20fdc}{\index{ion.\+h@{ion.\+h}!read\+\_\+xfrac@{read\+\_\+xfrac}}
\index{read\+\_\+xfrac@{read\+\_\+xfrac}!ion.\+h@{ion.\+h}}
\subsubsection[{read\+\_\+xfrac}]{\setlength{\rightskip}{0pt plus 5cm}void read\+\_\+xfrac (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{dirname, }
\item[{float $\ast$}]{buffer\+\_\+4d, }
\item[{float $\ast$}]{nion\+\_\+list, }
\item[{int}]{Nnion, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_ad2f727cabe5ba3e264757f33d2d20fdc}
Read in the history of ionized fraction (previous snapshot).


\begin{DoxyParams}{Parameters}
{\em dirname} & Directory of the xh (input) \\
\hline
{\em buffer\+\_\+4d} & 4\+D float output \\
\hline
{\em nion\+\_\+list} & List of minimum N\+\_\+gamma/\+N\+\_\+b (input) \\
\hline
{\em Nnion} & Number of elements in nion\+\_\+list \\
\hline
{\em N1} & 1st dimension grid (input) \\
\hline
{\em N2} & 2nd dimension grid (input) \\
\hline
{\em N3} & 3rd dimension grid (input) \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_aa174d816f11484078e55fe5af64c211b}{\index{ion.\+h@{ion.\+h}!reionization@{reionization}}
\index{reionization@{reionization}!ion.\+h@{ion.\+h}}
\subsubsection[{reionization}]{\setlength{\rightskip}{0pt plus 5cm}void reionization (
\begin{DoxyParamCaption}
\item[{float}]{Radii, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$}]{nh\+\_\+p, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$}]{ngamma\+\_\+p, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$}]{nxion\+\_\+p, }
\item[{float $\ast$}]{nion\+\_\+p, }
\item[{int}]{Nnion, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_aa174d816f11484078e55fe5af64c211b}
Core function to do semi-\/numnerical reionization estimation


\begin{DoxyParams}{Parameters}
{\em Radii} & Radius \\
\hline
{\em nh\+\_\+p} & Pointer to baryon density field \\
\hline
{\em ngamma\+\_\+p} & Pointer to photon density field \\
\hline
{\em nxion\+\_\+p} & Pointer to Xfrac field \\
\hline
{\em nion\+\_\+p} & nion arrays \\
\hline
{\em Nnion} & Total element of nion \\
\hline
{\em N1} & 1st dimension grid \\
\hline
{\em N2} & 2nd dimension grid \\
\hline
{\em N3} & 3rd dimension grid \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_aa8b5e455b9ae5c10e6b44ff5f28f8bf0}{\index{ion.\+h@{ion.\+h}!Setting\+\_\+\+Up\+\_\+\+Memory\+\_\+\+For\+\_\+ionz@{Setting\+\_\+\+Up\+\_\+\+Memory\+\_\+\+For\+\_\+ionz}}
\index{Setting\+\_\+\+Up\+\_\+\+Memory\+\_\+\+For\+\_\+ionz@{Setting\+\_\+\+Up\+\_\+\+Memory\+\_\+\+For\+\_\+ionz}!ion.\+h@{ion.\+h}}
\subsubsection[{Setting\+\_\+\+Up\+\_\+\+Memory\+\_\+\+For\+\_\+ionz}]{\setlength{\rightskip}{0pt plus 5cm}void Setting\+\_\+\+Up\+\_\+\+Memory\+\_\+\+For\+\_\+ionz (
\begin{DoxyParamCaption}
\item[{int}]{Nnion, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$}]{nh, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$}]{ngamma, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$}]{nxion}
\end{DoxyParamCaption}
)}}\label{ion_8h_aa8b5e455b9ae5c10e6b44ff5f28f8bf0}
Set up memory for nh, ngamma and nxion


\begin{DoxyParams}{Parameters}
{\em Nnion} & Number of nion \\
\hline
{\em N1} & 1st dimension grid \\
\hline
{\em N2} & 2nd dimension grid \\
\hline
{\em N3} & 3rd dimension grid \\
\hline
{\em nh} & density array \\
\hline
{\em ngamma} & source array \\
\hline
{\em nxion} & xfrac array \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_a553eda876fc651efecef3202b2046c77}{\index{ion.\+h@{ion.\+h}!smooth@{smooth}}
\index{smooth@{smooth}!ion.\+h@{ion.\+h}}
\subsubsection[{smooth}]{\setlength{\rightskip}{0pt plus 5cm}void smooth (
\begin{DoxyParamCaption}
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$}]{ro\+\_\+dum, }
\item[{float}]{Radii, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_a553eda876fc651efecef3202b2046c77}
Smooth radius with F\+F\+T


\begin{DoxyParams}{Parameters}
{\em ro\+\_\+dum} & density field \\
\hline
{\em Radii} & Smooth radius \\
\hline
{\em N1} & 1st dimension grid \\
\hline
{\em N2} & 2nd dimension grid \\
\hline
{\em N3} & 3rd dimension grid \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_a951c25f62971884a0b0aa5be6f903569}{\index{ion.\+h@{ion.\+h}!unpack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer@{unpack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer}}
\index{unpack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer@{unpack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer}!ion.\+h@{ion.\+h}}
\subsubsection[{unpack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer}]{\setlength{\rightskip}{0pt plus 5cm}void unpack\+\_\+3d\+\_\+array\+\_\+mpi\+\_\+transfer (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{input, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$}]{output, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_a951c25f62971884a0b0aa5be6f903569}
Convert 1\+D-\/float array to 3\+D-\/fftw\+\_\+real array. This is used to simplify M\+P\+I transfer process.


\begin{DoxyParams}{Parameters}
{\em input} & 1\+D-\/float array input \\
\hline
{\em output} & 3\+D-\/fftw\+\_\+real array output \\
\hline
{\em N1} & 1st dimension grid number \\
\hline
{\em N2} & 2nd dimension grid number \\
\hline
{\em N3} & 3rd dimension grid number \\
\hline
\end{DoxyParams}
\hypertarget{ion_8h_a81c6a9dba70c6b44213dc05309f5a8a2}{\index{ion.\+h@{ion.\+h}!unpack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer@{unpack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer}}
\index{unpack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer@{unpack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer}!ion.\+h@{ion.\+h}}
\subsubsection[{unpack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer}]{\setlength{\rightskip}{0pt plus 5cm}void unpack\+\_\+4d\+\_\+array\+\_\+mpi\+\_\+transfer (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{input, }
\item[{fftw\+\_\+real $\ast$$\ast$$\ast$$\ast$}]{output, }
\item[{int}]{Nnion, }
\item[{int}]{N1, }
\item[{int}]{N2, }
\item[{int}]{N3}
\end{DoxyParamCaption}
)}}\label{ion_8h_a81c6a9dba70c6b44213dc05309f5a8a2}
Convert 1\+D-\/float array to 3\+D-\/fftw\+\_\+real array. This is used to simplify M\+P\+I transfer process.


\begin{DoxyParams}{Parameters}
{\em input} & 1\+D-\/float array input \\
\hline
{\em output} & 3\+D-\/fftw\+\_\+real array output \\
\hline
{\em Nion} & Number of the choices of total reionizing photons/neutral baryon \\
\hline
{\em N1} & 1st dimension grid number \\
\hline
{\em N2} & 2nd dimension grid number \\
\hline
{\em N3} & 3rd dimension grid number \\
\hline
\end{DoxyParams}


\subsection{Variable Documentation}
\hypertarget{ion_8h_a1b21e15773869cae21bd1d502d49d715}{\index{ion.\+h@{ion.\+h}!constants@{constants}}
\index{constants@{constants}!ion.\+h@{ion.\+h}}
\subsubsection[{constants}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf C\+O\+N\+S\+T\+A\+N\+T\+S}  constants}}\label{ion_8h_a1b21e15773869cae21bd1d502d49d715}
\hypertarget{ion_8h_a62c41a4636d22215339031855db0e48c}{\index{ion.\+h@{ion.\+h}!input\+\_\+param@{input\+\_\+param}}
\index{input\+\_\+param@{input\+\_\+param}!ion.\+h@{ion.\+h}}
\subsubsection[{input\+\_\+param}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf params}  input\+\_\+param}}\label{ion_8h_a62c41a4636d22215339031855db0e48c}
\hypertarget{ion_8h_a6291b94bd446cba2e7517c12276ebd51}{\index{ion.\+h@{ion.\+h}!mympi@{mympi}}
\index{mympi@{mympi}!ion.\+h@{ion.\+h}}
\subsubsection[{mympi}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf my\+M\+P\+I}  mympi}}\label{ion_8h_a6291b94bd446cba2e7517c12276ebd51}
